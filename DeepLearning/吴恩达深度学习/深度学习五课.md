# ç¬¬äºŒå‘¨ ç¥ç»ç½‘ç»œçš„ç¼–ç¨‹åŸºç¡€

## 2.1 äºŒåˆ†ç±»(Binary Classification)

é€»è¾‘å›å½’æ˜¯ä¸€ä¸ªç”¨äºäºŒåˆ†ç±»(binary classification)çš„ç®—æ³•ã€‚åœ¨äºŒåˆ†ç±»é—®é¢˜ä¸­ï¼Œæˆ‘ä»¬ çš„ç›®æ ‡å°±æ˜¯ä¹ å¾—ä¸€ä¸ªåˆ†ç±»å™¨ï¼Œå®ƒä»¥ç‰¹å¾å‘é‡ä½œä¸ºè¾“å…¥ï¼Œç„¶åé¢„æµ‹è¾“å‡ºç»“æœ ğ‘¦ä¸º 1è¿˜æ˜¯ 0

**ç¬¦å·å®šä¹‰**

$x$ï¼šè¡¨ç¤ºä¸€ä¸ª$n_x$ç»´æ•°æ®ï¼Œä¸ºè¾“å…¥æ•°æ®ï¼Œç»´åº¦ä¸º$(n_x,1)$ï¼›Â 

$y$ï¼šè¡¨ç¤ºè¾“å‡ºç»“æœï¼Œå–å€¼ä¸º$(0,1)$ï¼›

$(x^{(i)},y^{(i)})$ï¼šè¡¨ç¤ºç¬¬$i$ç»„æ•°æ®ï¼Œå¯èƒ½æ˜¯è®­ç»ƒæ•°æ®ï¼Œä¹Ÿå¯èƒ½æ˜¯æµ‹è¯•æ•°æ®ï¼Œæ­¤å¤„é»˜è®¤ä¸ºè®­ç»ƒæ•°æ®ï¼›Â 

$X=[x^{(1)},x^{(2)},...,x^{(m)}]$ï¼šè¡¨ç¤ºæ‰€æœ‰çš„è®­ç»ƒæ•°æ®é›†çš„è¾“å…¥å€¼ï¼Œæ”¾åœ¨ä¸€ä¸ª $n_xÃ—m$çš„çŸ©é˜µä¸­ï¼Œå…¶ä¸­$m$è¡¨ç¤ºæ ·æœ¬æ•°ç›®;Â 

- æ•°æ®ä¹Ÿå¯ä»¥æŒ‰è¡Œï¼Œä½†å®ç°ç¥ç»ç½‘ç»œæ—¶ï¼Œè¿™ç§å½¢å¼æ›´ç®€å•

$Y=[y^{(1)},y^{(2)},...,y^{(m)}]$ï¼šå¯¹åº”è¡¨ç¤ºæ‰€æœ‰è®­ç»ƒæ•°æ®é›†çš„è¾“å‡ºå€¼ï¼Œç»´åº¦ä¸º$1Ã—m$ã€‚

ç”¨ä¸€å¯¹$(x,y)$æ¥è¡¨ç¤ºä¸€ä¸ªå•ç‹¬çš„æ ·æœ¬ï¼Œ$x$ä»£è¡¨$n_x$ç»´çš„ç‰¹å¾å‘é‡ï¼Œ$y$ è¡¨ç¤ºæ ‡ç­¾(è¾“å‡ºç»“æœ)åªèƒ½ä¸º0æˆ–1ã€‚

è®­ç»ƒé›†å°†ç”±$m$ä¸ªè®­ç»ƒæ ·æœ¬ç»„æˆï¼Œæœ‰æ—¶å€™ä¸ºäº†å¼ºè°ƒè¿™æ˜¯è®­ç»ƒæ ·æœ¬çš„ä¸ªæ•°ï¼Œä¼šå†™ä½œ$M_{train}$ï¼Œå½“æ¶‰åŠåˆ°æµ‹è¯•é›†çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¼šä½¿ç”¨$M_{test}$æ¥è¡¨ç¤ºæµ‹è¯•é›†çš„æ ·æœ¬æ•°



## 2.2 é€»è¾‘å›å½’(Logistic Regression)

ç»™å®šäº†è¾“å…¥ç‰¹å¾$X$ï¼Œ$\hat{y}$ è¡¨ç¤º $y$ ç­‰äº1çš„ä¸€ç§å¯èƒ½æ€§æˆ–è€…æ˜¯æœºä¼šï¼Œä¸€ç§çº¿æ€§å…³ç³»æ˜¯$\hat{y}={{w}^{T}}x+b$ã€‚

è¿™å¯¹äºäºŒå…ƒåˆ†ç±»é—®é¢˜æ¥è®²ä¸æ˜¯ä¸€ä¸ªéå¸¸å¥½çš„ç®—æ³•ï¼Œå› ä¸ºæƒ³è®©$\hat{y}$è¡¨ç¤ºå®é™…å€¼$y$ç­‰äº1çš„æœºç‡çš„è¯ï¼Œ$\hat{y}$ åº”è¯¥åœ¨0åˆ°1ä¹‹é—´ã€‚å› æ­¤åœ¨é€»è¾‘å›å½’ä¸­ï¼Œæˆ‘ä»¬çš„è¾“å‡ºåº”è¯¥æ˜¯$\hat{y}$ç­‰äºç”±ä¸Šé¢å¾—åˆ°çš„çº¿æ€§å‡½æ•°å¼å­ä½œä¸ºè‡ªå˜é‡çš„**sigmoid**å‡½æ•°ä¸­: $y=\sigma(w^Tx+b)$

å…³äº**sigmoid**å‡½æ•°çš„å…¬å¼æ˜¯è¿™æ ·çš„ï¼Œ$\sigma \left( z \right)=\frac{1}{1+{{e}^{-z}}}$,åœ¨è¿™é‡Œ$z$æ˜¯ä¸€ä¸ªå®æ•°

![image-20241123104324254](assets/image-20241123104324254.png)

åœ¨ç¬¦å·ä¸Šè¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯å½“æˆ‘ä»¬å¯¹ç¥ç»ç½‘ç»œè¿›è¡Œç¼–ç¨‹æ—¶ç»å¸¸ä¼šè®©å‚æ•°$w$å’Œå‚æ•°$b$åˆ†å¼€ï¼Œåœ¨è¿™é‡Œå‚æ•°$b$å¯¹åº”çš„æ˜¯ä¸€ç§åç½®ã€‚



## 2.3 é€»è¾‘å›å½’çš„ä»£ä»·å‡½æ•°ï¼ˆLogistic Regression Cost Functionï¼‰

å¹³æ–¹è¯¯å·®å¯¹äºé€»è¾‘å›å½’ä¸å¥½ç”¨ï¼Œå› ä¸ºå½“æˆ‘ä»¬åœ¨å­¦ä¹ é€»è¾‘å›å½’å‚æ•°çš„æ—¶å€™ï¼Œä¼šå‘ç°æˆ‘ä»¬çš„ä¼˜åŒ–ç›®æ ‡ä¸æ˜¯å‡¸ä¼˜åŒ–ï¼Œåªèƒ½æ‰¾åˆ°å¤šä¸ªå±€éƒ¨æœ€ä¼˜å€¼ï¼Œæ¢¯åº¦ä¸‹é™æ³•å¾ˆå¯èƒ½æ‰¾ä¸åˆ°å…¨å±€æœ€ä¼˜å€¼

åœ¨é€»è¾‘å›å½’ä¸­ç”¨åˆ°çš„æŸå¤±å‡½æ•°æ˜¯ï¼š$L\left( \hat{y},y \right)=-y\log(\hat{y})-(1-y)\log (1-\hat{y})$

- å½“$y=1$æ—¶æŸå¤±å‡½æ•°$L=-\log (\hat{y})$ï¼Œå¦‚æœæƒ³è¦æŸå¤±å‡½æ•°$L$å°½å¯èƒ½å¾—å°ï¼Œé‚£ä¹ˆ$\hat{y}$å°±è¦å°½å¯èƒ½å¤§ï¼Œå› ä¸º**sigmoid**å‡½æ•°å–å€¼$[0,1]$ï¼Œæ‰€ä»¥$\hat{y}$ä¼šæ— é™æ¥è¿‘äº1ã€‚
- å½“$y=0$æ—¶æŸå¤±å‡½æ•°$L=-\log (1-\hat{y})$ï¼Œå¦‚æœæƒ³è¦æŸå¤±å‡½æ•°$L$å°½å¯èƒ½å¾—å°ï¼Œé‚£ä¹ˆ$\hat{y}$å°±è¦å°½å¯èƒ½å°ï¼Œå› ä¸º**sigmoid**å‡½æ•°å–å€¼$[0,1]$ï¼Œæ‰€ä»¥$\hat{y}$ä¼šæ— é™æ¥è¿‘äº0ã€‚

æŸå¤±å‡½æ•°æ˜¯åœ¨**å•ä¸ªè®­ç»ƒæ ·æœ¬**ä¸­å®šä¹‰çš„ï¼Œå®ƒè¡¡é‡çš„æ˜¯ç®—æ³•åœ¨å•ä¸ªè®­ç»ƒæ ·æœ¬ä¸­è¡¨ç°å¦‚ä½•ï¼Œä¸ºäº†è¡¡é‡ç®—æ³•åœ¨å…¨éƒ¨è®­ç»ƒæ ·æœ¬ä¸Šçš„è¡¨ç°å¦‚ä½•ï¼Œæˆ‘ä»¬éœ€è¦å®šä¹‰ä¸€ä¸ªç®—æ³•çš„**ä»£ä»·å‡½æ•°**ï¼Œç®—æ³•çš„ä»£ä»·å‡½æ•°æ˜¯å¯¹$m$ä¸ªæ ·æœ¬çš„æŸå¤±å‡½æ•°æ±‚å’Œç„¶åé™¤ä»¥$m$:

$J\left( w,b \right)=\frac{1}{m}\sum\limits_{i=1}^{m}{L\left( {{{\hat{y}}}^{(i)}},{{y}^{(i)}} \right)}=\frac{1}{m}\sum\limits_{i=1}^{m}{\left( -{{y}^{(i)}}\log {{{\hat{y}}}^{(i)}}-(1-{{y}^{(i)}})\log (1-{{{\hat{y}}}^{(i)}}) \right)}$



## 2.4 æ¢¯åº¦ä¸‹é™æ³•ï¼ˆGradient Descentï¼‰

åœ¨æµ‹è¯•é›†ä¸Šï¼Œé€šè¿‡æœ€å°åŒ–ä»£ä»·å‡½æ•°ï¼ˆæˆæœ¬å‡½æ•°ï¼‰$J(w,b)$æ¥è®­ç»ƒçš„å‚æ•°$w$å’Œ$b$

ä»£ä»·å‡½æ•°ï¼ˆæˆæœ¬å‡½æ•°ï¼‰$J(w,b)$æ˜¯ä¸€ä¸ªå‡¸å‡½æ•°(**convex function**)ï¼Œæœ‰å…¨å±€æœ€ä¼˜è§£

- ![image-20241124204216773](assets/image-20241124204216773.png)

**1.åˆå§‹åŒ–**

å¯¹äºé€»è¾‘å›å½’æ¥è¯´ï¼Œå‡ ä¹ä»»æ„çš„åˆå§‹åŒ–æ–¹æ³•éƒ½æœ‰æ•ˆï¼šå› ä¸ºä»£ä»·å‡½æ•°æ˜¯å‡¸å‡½æ•°ï¼Œæ‰€ä»¥æœ€ç»ˆéƒ½åº”è¯¥åˆ°è¾¾æˆ–æ¥è¿‘å…¨å±€æœ€ä¼˜ç‚¹

- é€šå¸¸ç”¨0åˆå§‹åŒ–

**2.æœæœ€é™¡ï¼ˆæ¢¯åº¦ä¸‹é™æœ€å¿«ï¼‰çš„æ–¹å‘å‰è¿›ä¸€æ­¥**

**3.ç›´åˆ°èµ°åˆ°å…¨å±€æœ€ä¼˜è§£æˆ–è€…æ¥è¿‘å…¨å±€æœ€ä¼˜è§£çš„åœ°æ–¹**

**åªæœ‰ä¸€ä¸ªå‚æ•°**
$$
Repeat\ w := w - \alpha \frac{dJ(w)}{dw}
$$

- å…¶ä¸­ $\alpha$ ä¸ºå­¦ä¹ ç‡ï¼Œç”¨æ¥æ§åˆ¶æ­¥é•¿

**æœ‰ä¸¤ä¸ªå‚æ•°**
$$
Repeat\ w := w - \alpha\frac{\partial J(w,b)}{\partial w}, b:= b-\alpha \frac{\partial J(w,b)}{\partial b}
$$

- æ±‚åå¯¼



## 2.5 å¯¼æ•°ï¼ˆDerivativesï¼‰

## 2.6 æ›´å¤šå¯¼æ•°çš„ä¾‹å­

## 2.7 è®¡ç®—å›¾ï¼ˆComputation Graphï¼‰

å¯ä»¥è¯´ï¼Œä¸€ä¸ªç¥ç»ç½‘ç»œçš„è®¡ç®—ï¼Œéƒ½æ˜¯æŒ‰ç…§å‰å‘æˆ–åå‘ä¼ æ’­è¿‡ç¨‹ç»„ç»‡çš„ã€‚é¦–å…ˆæˆ‘ä»¬è®¡ç®—å‡ºä¸€ä¸ªæ–°çš„ç½‘ç»œçš„è¾“å‡ºï¼ˆå‰å‘è¿‡ç¨‹ï¼‰ï¼Œç´§æ¥ç€è¿›è¡Œä¸€ä¸ªåå‘ä¼ è¾“æ“ä½œã€‚åè€…æˆ‘ä»¬ç”¨æ¥è®¡ç®—å‡ºå¯¹åº”çš„æ¢¯åº¦æˆ–å¯¼æ•°ã€‚

**ä¸€ä¸ªç®€åŒ–çš„ä¾‹å­**

![image-20241125185954119](assets/image-20241125185954119.png)



## 2.8 ä½¿ç”¨è®¡ç®—å›¾æ±‚å¯¼æ•°

![image-20241125190319234](assets/image-20241125190319234.png)

$\frac{dJ}{du}=\frac{dJ}{dv}\frac{dv}{du}$ ï¼Œ $\frac{dJ}{db}=\frac{dJ}{du}\frac{du}{db}$ ï¼Œ$\frac{dJ}{da}=\frac{dJ}{du}\frac{du}{da}$

åœ¨åå‘ä¼ æ’­ç®—æ³•ä¸­çš„æœ¯è¯­ï¼Œæˆ‘ä»¬çœ‹åˆ°ï¼Œå¦‚æœä½ æƒ³è®¡ç®—æœ€åè¾“å‡ºå˜é‡çš„å¯¼æ•°ï¼Œä½¿ç”¨ä½ æœ€å…³å¿ƒçš„å˜é‡å¯¹$v$çš„å¯¼æ•°ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±åšå®Œäº†ä¸€æ­¥åå‘ä¼ æ’­ï¼Œåœ¨è¿™ä¸ªæµç¨‹å›¾ä¸­æ˜¯ä¸€ä¸ªåå‘æ­¥éª¤ã€‚



## 2.9 é€»è¾‘å›å½’ä¸­çš„æ¢¯åº¦ä¸‹é™

å‡è®¾æ ·æœ¬åªæœ‰ä¸¤ä¸ªç‰¹å¾${{x}_{1}}$å’Œ${{x}_{2}}$ï¼Œä¸ºäº†è®¡ç®—$z$ï¼Œæˆ‘ä»¬éœ€è¦è¾“å…¥å‚æ•°${{w}_{1}}$ã€${{w}_{2}}$ å’Œ$b$ï¼Œé™¤æ­¤ä¹‹å¤–è¿˜æœ‰ç‰¹å¾å€¼${{x}_{1}}$å’Œ${{x}_{2}}$ã€‚å› æ­¤$z$çš„è®¡ç®—å…¬å¼ä¸ºï¼š
$$
z={{w}_{1}}{{x}_{1}}+{{w}_{2}}{{x}_{2}}+b
$$

å›æƒ³ä¸€ä¸‹é€»è¾‘å›å½’çš„å…¬å¼å®šä¹‰å¦‚ä¸‹ï¼š
$$
\hat{y}=a=\sigma (z)\\
z={{w}^{T}}x+b \\
\sigma \left( z \right)=\frac{1}{1+{{e}^{-z}}}
$$

æŸå¤±å‡½æ•°ï¼š
$$
L( {{{\hat{y}}}^{(i)}},{{y}^{(i)}})=-{{y}^{(i)}}\log {{\hat{y}}^{(i)}}-(1-{{y}^{(i)}})\log (1-{{\hat{y}}^{(i)}})
$$
ä»£ä»·å‡½æ•°ï¼š
$$
J\left( w,b \right)=\frac{1}{m}\sum\nolimits_{i}^{m}{L( {{{\hat{y}}}^{(i)}},{{y}^{(i)}})}
$$
å‡è®¾ç°åœ¨åªè€ƒè™‘å•ä¸ªæ ·æœ¬çš„æƒ…å†µï¼Œå•ä¸ªæ ·æœ¬çš„ä»£ä»·å‡½æ•°å®šä¹‰å¦‚ä¸‹ï¼š
$$
L(a,y)=-(y\log (a)+(1-y)\log (1-a))
$$
å…¶ä¸­$a$æ˜¯é€»è¾‘å›å½’çš„è¾“å‡ºï¼Œ$y$æ˜¯æ ·æœ¬çš„æ ‡ç­¾å€¼ã€‚ç°åœ¨è®©æˆ‘ä»¬ç”»å‡ºè¡¨ç¤ºè¿™ä¸ªè®¡ç®—çš„è®¡ç®—å›¾ã€‚

$w$å’Œ$b$çš„ä¿®æ­£é‡å¯ä»¥è¡¨è¾¾å¦‚ä¸‹ï¼š
$$
w:=w-\alpha \frac{\partial J(w,b)}{\partial w}\\
b:=b-\alpha\frac{\partial J(w,b)}{\partial b}
$$
![image-20241125194213597](assets/image-20241125194213597.png)

- $\frac{dL(a,y)}{da}=-\frac{y}{a}+\frac{1-y}{1-a}$
- $\frac{da}{dz}=a*(1-a)=>\frac{dL}{dz}=a-y$
- $\frac{dL}{dw_1}=x_1*\frac{dL}{dz},\frac{dL}{dw_2}=x_2*\frac{dL}{dz},\frac{dL}{db}=\frac{dL}{dz}$



## 2.10 mä¸ªæ ·æœ¬çš„æ¢¯åº¦ä¸‹é™

$$
\frac{\partial J}{\partial w_i} = \frac{1}{m}\sum_{j=1}^{m}\frac{\partial L(a^{(j)}, y^{(j)})}{\partial w_i}
$$

```
J=0;dw1=0;dw2=0;db=0;
for i = 1 to m
    z(i) = w^T * x(i)+b;
    a(i) = sigmoid(z(i));
    J += -[y(i)log(a(i))+(1-y(i))log(1-a(i));
    dz(i) = a(i)-y(i);
    dw1 += x1(i)dz(i);
    dw2 += x2(i)dz(i);
    db += dz(i);
J/= m;
dw1/= m;
dw2/= m;
db/= m;
w=w-alpha*dw
b=b-alpha*db
```

## 2.11 å‘é‡åŒ–(Vectorization)

```python
import numpy as np #å¯¼å…¥numpyåº“
a = np.array([1,2,3,4]) #åˆ›å»ºä¸€ä¸ªæ•°æ®a
print(a)
print(a.shape)
# [1 2 3 4]

import time #å¯¼å…¥æ—¶é—´åº“
a = np.random.rand(1000000) # ï¼ˆ1000000,ï¼‰çš„ä¸€ç»´æ•°ç»„
print(a.shape)
b = np.random.rand(1000000) #é€šè¿‡roundéšæœºå¾—åˆ°ä¸¤ä¸ªä¸€ç™¾ä¸‡ç»´åº¦çš„æ•°ç»„
tic = time.time() #ç°åœ¨æµ‹é‡ä¸€ä¸‹å½“å‰æ—¶é—´

#å‘é‡åŒ–çš„ç‰ˆæœ¬
c = np.dot(a,b) # é€šè¿‡np.dotå‡½æ•°è®¡ç®—ä¸¤ä¸ªå‘é‡çš„ç‚¹ç§¯
print(c.shape)
toc = time.time()
print("Vectorized version:" + str(1000*(toc-tic)) +"ms") #æ‰“å°ä¸€ä¸‹å‘é‡åŒ–çš„ç‰ˆæœ¬çš„æ—¶é—´

#ç»§ç»­å¢åŠ éå‘é‡åŒ–çš„ç‰ˆæœ¬
c = 0
tic = time.time()
for i in range(1000000):
    c += a[i]*b[i]
toc = time.time()
print("For loop:" + str(1000*(toc-tic)) + "ms")#æ‰“å°forå¾ªç¯çš„ç‰ˆæœ¬çš„æ—¶é—´
```

