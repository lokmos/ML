# ç¬¬äºŒå‘¨ ç¥ç»ç½‘ç»œçš„ç¼–ç¨‹åŸºç¡€

## 2.1 äºŒåˆ†ç±»(Binary Classification)

é€»è¾‘å›å½’æ˜¯ä¸€ä¸ªç”¨äºäºŒåˆ†ç±»(binary classification)çš„ç®—æ³•ã€‚åœ¨äºŒåˆ†ç±»é—®é¢˜ä¸­ï¼Œæˆ‘ä»¬ çš„ç›®æ ‡å°±æ˜¯ä¹ å¾—ä¸€ä¸ªåˆ†ç±»å™¨ï¼Œå®ƒä»¥ç‰¹å¾å‘é‡ä½œä¸ºè¾“å…¥ï¼Œç„¶åé¢„æµ‹è¾“å‡ºç»“æœ ğ‘¦ä¸º 1è¿˜æ˜¯ 0

**ç¬¦å·å®šä¹‰**

$x$ï¼šè¡¨ç¤ºä¸€ä¸ª$n_x$ç»´æ•°æ®ï¼Œä¸ºè¾“å…¥æ•°æ®ï¼Œç»´åº¦ä¸º$(n_x,1)$ï¼›Â 

$y$ï¼šè¡¨ç¤ºè¾“å‡ºç»“æœï¼Œå–å€¼ä¸º$(0,1)$ï¼›

$(x^{(i)},y^{(i)})$ï¼šè¡¨ç¤ºç¬¬$i$ç»„æ•°æ®ï¼Œå¯èƒ½æ˜¯è®­ç»ƒæ•°æ®ï¼Œä¹Ÿå¯èƒ½æ˜¯æµ‹è¯•æ•°æ®ï¼Œæ­¤å¤„é»˜è®¤ä¸ºè®­ç»ƒæ•°æ®ï¼›Â 

$X=[x^{(1)},x^{(2)},...,x^{(m)}]$ï¼šè¡¨ç¤ºæ‰€æœ‰çš„è®­ç»ƒæ•°æ®é›†çš„è¾“å…¥å€¼ï¼Œæ”¾åœ¨ä¸€ä¸ª $n_xÃ—m$çš„çŸ©é˜µä¸­ï¼Œå…¶ä¸­$m$è¡¨ç¤ºæ ·æœ¬æ•°ç›®;Â 

- æ•°æ®ä¹Ÿå¯ä»¥æŒ‰è¡Œï¼Œä½†å®ç°ç¥ç»ç½‘ç»œæ—¶ï¼Œè¿™ç§å½¢å¼æ›´ç®€å•

$Y=[y^{(1)},y^{(2)},...,y^{(m)}]$ï¼šå¯¹åº”è¡¨ç¤ºæ‰€æœ‰è®­ç»ƒæ•°æ®é›†çš„è¾“å‡ºå€¼ï¼Œç»´åº¦ä¸º$1Ã—m$ã€‚

ç”¨ä¸€å¯¹$(x,y)$æ¥è¡¨ç¤ºä¸€ä¸ªå•ç‹¬çš„æ ·æœ¬ï¼Œ$x$ä»£è¡¨$n_x$ç»´çš„ç‰¹å¾å‘é‡ï¼Œ$y$ è¡¨ç¤ºæ ‡ç­¾(è¾“å‡ºç»“æœ)åªèƒ½ä¸º0æˆ–1ã€‚

è®­ç»ƒé›†å°†ç”±$m$ä¸ªè®­ç»ƒæ ·æœ¬ç»„æˆï¼Œæœ‰æ—¶å€™ä¸ºäº†å¼ºè°ƒè¿™æ˜¯è®­ç»ƒæ ·æœ¬çš„ä¸ªæ•°ï¼Œä¼šå†™ä½œ$M_{train}$ï¼Œå½“æ¶‰åŠåˆ°æµ‹è¯•é›†çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¼šä½¿ç”¨$M_{test}$æ¥è¡¨ç¤ºæµ‹è¯•é›†çš„æ ·æœ¬æ•°



## 2.2 é€»è¾‘å›å½’(Logistic Regression)

ç»™å®šäº†è¾“å…¥ç‰¹å¾$X$ï¼Œ$\hat{y}$ è¡¨ç¤º $y$ ç­‰äº1çš„ä¸€ç§å¯èƒ½æ€§æˆ–è€…æ˜¯æœºä¼šï¼Œä¸€ç§çº¿æ€§å…³ç³»æ˜¯$\hat{y}={{w}^{T}}x+b$ã€‚

è¿™å¯¹äºäºŒå…ƒåˆ†ç±»é—®é¢˜æ¥è®²ä¸æ˜¯ä¸€ä¸ªéå¸¸å¥½çš„ç®—æ³•ï¼Œå› ä¸ºæƒ³è®©$\hat{y}$è¡¨ç¤ºå®é™…å€¼$y$ç­‰äº1çš„æœºç‡çš„è¯ï¼Œ$\hat{y}$ åº”è¯¥åœ¨0åˆ°1ä¹‹é—´ã€‚å› æ­¤åœ¨é€»è¾‘å›å½’ä¸­ï¼Œæˆ‘ä»¬çš„è¾“å‡ºåº”è¯¥æ˜¯$\hat{y}$ç­‰äºç”±ä¸Šé¢å¾—åˆ°çš„çº¿æ€§å‡½æ•°å¼å­ä½œä¸ºè‡ªå˜é‡çš„**sigmoid**å‡½æ•°ä¸­: $y=\sigma(w^Tx+b)$

å…³äº**sigmoid**å‡½æ•°çš„å…¬å¼æ˜¯è¿™æ ·çš„ï¼Œ$\sigma \left( z \right)=\frac{1}{1+{{e}^{-z}}}$,åœ¨è¿™é‡Œ$z$æ˜¯ä¸€ä¸ªå®æ•°

![image-20241123104324254](assets/image-20241123104324254.png)

åœ¨ç¬¦å·ä¸Šè¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯å½“æˆ‘ä»¬å¯¹ç¥ç»ç½‘ç»œè¿›è¡Œç¼–ç¨‹æ—¶ç»å¸¸ä¼šè®©å‚æ•°$w$å’Œå‚æ•°$b$åˆ†å¼€ï¼Œåœ¨è¿™é‡Œå‚æ•°$b$å¯¹åº”çš„æ˜¯ä¸€ç§åç½®ã€‚



## 2.3 é€»è¾‘å›å½’çš„ä»£ä»·å‡½æ•°ï¼ˆLogistic Regression Cost Functionï¼‰

å¹³æ–¹è¯¯å·®å¯¹äºé€»è¾‘å›å½’ä¸å¥½ç”¨ï¼Œå› ä¸ºå½“æˆ‘ä»¬åœ¨å­¦ä¹ é€»è¾‘å›å½’å‚æ•°çš„æ—¶å€™ï¼Œä¼šå‘ç°æˆ‘ä»¬çš„ä¼˜åŒ–ç›®æ ‡ä¸æ˜¯å‡¸ä¼˜åŒ–ï¼Œåªèƒ½æ‰¾åˆ°å¤šä¸ªå±€éƒ¨æœ€ä¼˜å€¼ï¼Œæ¢¯åº¦ä¸‹é™æ³•å¾ˆå¯èƒ½æ‰¾ä¸åˆ°å…¨å±€æœ€ä¼˜å€¼

åœ¨é€»è¾‘å›å½’ä¸­ç”¨åˆ°çš„æŸå¤±å‡½æ•°æ˜¯ï¼š$L\left( \hat{y},y \right)=-y\log(\hat{y})-(1-y)\log (1-\hat{y})$

- å½“$y=1$æ—¶æŸå¤±å‡½æ•°$L=-\log (\hat{y})$ï¼Œå¦‚æœæƒ³è¦æŸå¤±å‡½æ•°$L$å°½å¯èƒ½å¾—å°ï¼Œé‚£ä¹ˆ$\hat{y}$å°±è¦å°½å¯èƒ½å¤§ï¼Œå› ä¸º**sigmoid**å‡½æ•°å–å€¼$[0,1]$ï¼Œæ‰€ä»¥$\hat{y}$ä¼šæ— é™æ¥è¿‘äº1ã€‚
- å½“$y=0$æ—¶æŸå¤±å‡½æ•°$L=-\log (1-\hat{y})$ï¼Œå¦‚æœæƒ³è¦æŸå¤±å‡½æ•°$L$å°½å¯èƒ½å¾—å°ï¼Œé‚£ä¹ˆ$\hat{y}$å°±è¦å°½å¯èƒ½å°ï¼Œå› ä¸º**sigmoid**å‡½æ•°å–å€¼$[0,1]$ï¼Œæ‰€ä»¥$\hat{y}$ä¼šæ— é™æ¥è¿‘äº0ã€‚

æŸå¤±å‡½æ•°æ˜¯åœ¨**å•ä¸ªè®­ç»ƒæ ·æœ¬**ä¸­å®šä¹‰çš„ï¼Œå®ƒè¡¡é‡çš„æ˜¯ç®—æ³•åœ¨å•ä¸ªè®­ç»ƒæ ·æœ¬ä¸­è¡¨ç°å¦‚ä½•ï¼Œä¸ºäº†è¡¡é‡ç®—æ³•åœ¨å…¨éƒ¨è®­ç»ƒæ ·æœ¬ä¸Šçš„è¡¨ç°å¦‚ä½•ï¼Œæˆ‘ä»¬éœ€è¦å®šä¹‰ä¸€ä¸ªç®—æ³•çš„**ä»£ä»·å‡½æ•°**ï¼Œç®—æ³•çš„ä»£ä»·å‡½æ•°æ˜¯å¯¹$m$ä¸ªæ ·æœ¬çš„æŸå¤±å‡½æ•°æ±‚å’Œç„¶åé™¤ä»¥$m$:

$J\left( w,b \right)=\frac{1}{m}\sum\limits_{i=1}^{m}{L\left( {{{\hat{y}}}^{(i)}},{{y}^{(i)}} \right)}=\frac{1}{m}\sum\limits_{i=1}^{m}{\left( -{{y}^{(i)}}\log {{{\hat{y}}}^{(i)}}-(1-{{y}^{(i)}})\log (1-{{{\hat{y}}}^{(i)}}) \right)}$



## 2.4 æ¢¯åº¦ä¸‹é™æ³•ï¼ˆGradient Descentï¼‰

åœ¨æµ‹è¯•é›†ä¸Šï¼Œé€šè¿‡æœ€å°åŒ–ä»£ä»·å‡½æ•°ï¼ˆæˆæœ¬å‡½æ•°ï¼‰$J(w,b)$æ¥è®­ç»ƒçš„å‚æ•°$w$å’Œ$b$

ä»£ä»·å‡½æ•°ï¼ˆæˆæœ¬å‡½æ•°ï¼‰$J(w,b)$æ˜¯ä¸€ä¸ªå‡¸å‡½æ•°(**convex function**)ï¼Œæœ‰å…¨å±€æœ€ä¼˜è§£

- ![image-20241124204216773](assets/image-20241124204216773.png)

**1.åˆå§‹åŒ–**

å¯¹äºé€»è¾‘å›å½’æ¥è¯´ï¼Œå‡ ä¹ä»»æ„çš„åˆå§‹åŒ–æ–¹æ³•éƒ½æœ‰æ•ˆï¼šå› ä¸ºä»£ä»·å‡½æ•°æ˜¯å‡¸å‡½æ•°ï¼Œæ‰€ä»¥æœ€ç»ˆéƒ½åº”è¯¥åˆ°è¾¾æˆ–æ¥è¿‘å…¨å±€æœ€ä¼˜ç‚¹

- é€šå¸¸ç”¨0åˆå§‹åŒ–

**2.æœæœ€é™¡ï¼ˆæ¢¯åº¦ä¸‹é™æœ€å¿«ï¼‰çš„æ–¹å‘å‰è¿›ä¸€æ­¥**

**3.ç›´åˆ°èµ°åˆ°å…¨å±€æœ€ä¼˜è§£æˆ–è€…æ¥è¿‘å…¨å±€æœ€ä¼˜è§£çš„åœ°æ–¹**

**åªæœ‰ä¸€ä¸ªå‚æ•°**
$$
Repeat\ w := w - \alpha \frac{dJ(w)}{dw}
$$

- å…¶ä¸­ $\alpha$ ä¸ºå­¦ä¹ ç‡ï¼Œç”¨æ¥æ§åˆ¶æ­¥é•¿

**æœ‰ä¸¤ä¸ªå‚æ•°**
$$
Repeat\ w := w - \alpha\frac{\partial J(w,b)}{\partial w}, b:= b-\alpha \frac{\partial J(w,b)}{\partial b}
$$

- æ±‚åå¯¼



## 2.5 å¯¼æ•°ï¼ˆDerivativesï¼‰

## 2.6 æ›´å¤šå¯¼æ•°çš„ä¾‹å­

## 2.7 è®¡ç®—å›¾ï¼ˆComputation Graphï¼‰

å¯ä»¥è¯´ï¼Œä¸€ä¸ªç¥ç»ç½‘ç»œçš„è®¡ç®—ï¼Œéƒ½æ˜¯æŒ‰ç…§å‰å‘æˆ–åå‘ä¼ æ’­è¿‡ç¨‹ç»„ç»‡çš„ã€‚é¦–å…ˆæˆ‘ä»¬è®¡ç®—å‡ºä¸€ä¸ªæ–°çš„ç½‘ç»œçš„è¾“å‡ºï¼ˆå‰å‘è¿‡ç¨‹ï¼‰ï¼Œç´§æ¥ç€è¿›è¡Œä¸€ä¸ªåå‘ä¼ è¾“æ“ä½œã€‚åè€…æˆ‘ä»¬ç”¨æ¥è®¡ç®—å‡ºå¯¹åº”çš„æ¢¯åº¦æˆ–å¯¼æ•°ã€‚

**ä¸€ä¸ªç®€åŒ–çš„ä¾‹å­**

![image-20241125185954119](assets/image-20241125185954119.png)



## 2.8 ä½¿ç”¨è®¡ç®—å›¾æ±‚å¯¼æ•°

![image-20241125190319234](assets/image-20241125190319234.png)

$\frac{dJ}{du}=\frac{dJ}{dv}\frac{dv}{du}$ ï¼Œ $\frac{dJ}{db}=\frac{dJ}{du}\frac{du}{db}$ ï¼Œ$\frac{dJ}{da}=\frac{dJ}{du}\frac{du}{da}$

åœ¨åå‘ä¼ æ’­ç®—æ³•ä¸­çš„æœ¯è¯­ï¼Œæˆ‘ä»¬çœ‹åˆ°ï¼Œå¦‚æœä½ æƒ³è®¡ç®—æœ€åè¾“å‡ºå˜é‡çš„å¯¼æ•°ï¼Œä½¿ç”¨ä½ æœ€å…³å¿ƒçš„å˜é‡å¯¹$v$çš„å¯¼æ•°ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±åšå®Œäº†ä¸€æ­¥åå‘ä¼ æ’­ï¼Œåœ¨è¿™ä¸ªæµç¨‹å›¾ä¸­æ˜¯ä¸€ä¸ªåå‘æ­¥éª¤ã€‚



## 2.9 é€»è¾‘å›å½’ä¸­çš„æ¢¯åº¦ä¸‹é™

å‡è®¾æ ·æœ¬åªæœ‰ä¸¤ä¸ªç‰¹å¾${{x}_{1}}$å’Œ${{x}_{2}}$ï¼Œä¸ºäº†è®¡ç®—$z$ï¼Œæˆ‘ä»¬éœ€è¦è¾“å…¥å‚æ•°${{w}_{1}}$ã€${{w}_{2}}$ å’Œ$b$ï¼Œé™¤æ­¤ä¹‹å¤–è¿˜æœ‰ç‰¹å¾å€¼${{x}_{1}}$å’Œ${{x}_{2}}$ã€‚å› æ­¤$z$çš„è®¡ç®—å…¬å¼ä¸ºï¼š
$$
z={{w}_{1}}{{x}_{1}}+{{w}_{2}}{{x}_{2}}+b
$$

å›æƒ³ä¸€ä¸‹é€»è¾‘å›å½’çš„å…¬å¼å®šä¹‰å¦‚ä¸‹ï¼š
$$
\hat{y}=a=\sigma (z)\\
z={{w}^{T}}x+b \\
\sigma \left( z \right)=\frac{1}{1+{{e}^{-z}}}
$$

æŸå¤±å‡½æ•°ï¼š
$$
L( {{{\hat{y}}}^{(i)}},{{y}^{(i)}})=-{{y}^{(i)}}\log {{\hat{y}}^{(i)}}-(1-{{y}^{(i)}})\log (1-{{\hat{y}}^{(i)}})
$$
ä»£ä»·å‡½æ•°ï¼š
$$
J\left( w,b \right)=\frac{1}{m}\sum\nolimits_{i}^{m}{L( {{{\hat{y}}}^{(i)}},{{y}^{(i)}})}
$$
å‡è®¾ç°åœ¨åªè€ƒè™‘å•ä¸ªæ ·æœ¬çš„æƒ…å†µï¼Œå•ä¸ªæ ·æœ¬çš„ä»£ä»·å‡½æ•°å®šä¹‰å¦‚ä¸‹ï¼š
$$
L(a,y)=-(y\log (a)+(1-y)\log (1-a))
$$
å…¶ä¸­$a$æ˜¯é€»è¾‘å›å½’çš„è¾“å‡ºï¼Œ$y$æ˜¯æ ·æœ¬çš„æ ‡ç­¾å€¼ã€‚ç°åœ¨è®©æˆ‘ä»¬ç”»å‡ºè¡¨ç¤ºè¿™ä¸ªè®¡ç®—çš„è®¡ç®—å›¾ã€‚

$w$å’Œ$b$çš„ä¿®æ­£é‡å¯ä»¥è¡¨è¾¾å¦‚ä¸‹ï¼š
$$
w:=w-\alpha \frac{\partial J(w,b)}{\partial w}\\
b:=b-\alpha\frac{\partial J(w,b)}{\partial b}
$$
![image-20241125194213597](assets/image-20241125194213597.png)

- $\frac{dL(a,y)}{da}=-\frac{y}{a}+\frac{1-y}{1-a}$
- $\frac{da}{dz}=a*(1-a)=>\frac{dL}{dz}=a-y$
- $\frac{dL}{dw_1}=x_1*\frac{dL}{dz},\frac{dL}{dw_2}=x_2*\frac{dL}{dz},\frac{dL}{db}=\frac{dL}{dz}$



## 2.10 mä¸ªæ ·æœ¬çš„æ¢¯åº¦ä¸‹é™

$$
\frac{\partial J}{\partial w_i} = \frac{1}{m}\sum_{j=1}^{m}\frac{\partial L(a^{(j)}, y^{(j)})}{\partial w_i}
$$

```
J=0;dw1=0;dw2=0;db=0;
for i = 1 to m
    z(i) = w^T * x(i)+b;
    a(i) = sigmoid(z(i));
    J += -[y(i)log(a(i))+(1-y(i))log(1-a(i));
    dz(i) = a(i)-y(i);
    dw1 += x1(i)dz(i);
    dw2 += x2(i)dz(i);
    db += dz(i);
J/= m;
dw1/= m;
dw2/= m;
db/= m;
w=w-alpha*dw
b=b-alpha*db
```

## 2.11 å‘é‡åŒ–(Vectorization)

```python
import numpy as np #å¯¼å…¥numpyåº“
a = np.array([1,2,3,4]) #åˆ›å»ºä¸€ä¸ªæ•°æ®a
print(a)
print(a.shape)
# [1 2 3 4]

import time #å¯¼å…¥æ—¶é—´åº“
a = np.random.rand(1000000) # ï¼ˆ1000000,ï¼‰çš„ä¸€ç»´æ•°ç»„
print(a.shape)
b = np.random.rand(1000000) #é€šè¿‡roundéšæœºå¾—åˆ°ä¸¤ä¸ªä¸€ç™¾ä¸‡ç»´åº¦çš„æ•°ç»„
tic = time.time() #ç°åœ¨æµ‹é‡ä¸€ä¸‹å½“å‰æ—¶é—´

#å‘é‡åŒ–çš„ç‰ˆæœ¬
c = np.dot(a,b) # é€šè¿‡np.dotå‡½æ•°è®¡ç®—ä¸¤ä¸ªå‘é‡çš„ç‚¹ç§¯
print(c.shape)
toc = time.time()
print("Vectorized version:" + str(1000*(toc-tic)) +"ms") #æ‰“å°ä¸€ä¸‹å‘é‡åŒ–çš„ç‰ˆæœ¬çš„æ—¶é—´

#ç»§ç»­å¢åŠ éå‘é‡åŒ–çš„ç‰ˆæœ¬
c = 0
tic = time.time()
for i in range(1000000):
    c += a[i]*b[i]
toc = time.time()
print("For loop:" + str(1000*(toc-tic)) + "ms")#æ‰“å°forå¾ªç¯çš„ç‰ˆæœ¬çš„æ—¶é—´
```

## 2.12 å‘é‡åŒ–çš„æ›´å¤šä¾‹å­

![image-20241126165315816](assets/image-20241126165315816.png)

## 2.13 å‘é‡åŒ–é€»è¾‘å›å½’

```python
Z = w.T @ X + b 
# X: [n_x, m]
# x: [n_x, 1]
# b: [1]
# Z: [1, m]
```

## 2.14 å‘é‡åŒ–é€»è¾‘å›å½’çš„æ¢¯åº¦è¾“å‡º

$Z = w^{T}X + b = np.dot( w.T,X)+b$

$A = \sigma( Z )$

$dZ = A - Y$

${{dw} = \frac{1}{m}*X*dz^{T}\ }$

$db= \frac{1}{m}*np.sum( dZ)$

$w: = w - a*dw$

$b: = b - a*db$

## 2.15 å¹¿æ’­

```python
A = np.array([[56.0, 0.0, 4.4, 68.0],
              [1.2, 104.0, 52.0, 8.0],
              [1.8, 135.0, 99.0, 0.9]]) #åˆ›å»ºä¸€ä¸ª3*4çš„çŸ©é˜µ

cal = A.sum(axis = 0) # æŒ‰è¡Œåˆå¹¶ï¼Œå³æŒ‰åˆ—æ±‚å’Œï¼Œå¾—åˆ° 1*4 çš„çŸ©é˜µ
percentage = 100 * A / (cal.reshape(1, 4))
```

- ä»æŠ€æœ¯ä¸Šæ¥è¯´ï¼Œä¸éœ€è¦ reshapeï¼Œä¸Šä¸€æ­¥å¾—åˆ°çš„å°±æ˜¯ 1 * 4 çš„çŸ©é˜µï¼Œä½†åœ¨å®é™…ç¼–ç¨‹ä¸­ï¼ŒåŠ ä¸Šreshapeèƒ½å¤Ÿç¡®ä¿å¾—åˆ°éœ€è¦çš„çŸ©é˜µå½¢çŠ¶

å¹¿æ’­çš„æ ¸å¿ƒè§„åˆ™æ˜¯ï¼š**ä»å³å‘å·¦**æ¯”è¾ƒä¸¤ä¸ªæ•°ç»„çš„å½¢çŠ¶ï¼Œåªè¦æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ä¹‹ä¸€ï¼Œå°±å¯ä»¥è¿›è¡Œå¹¿æ’­ï¼Œå¹¿æ’­ä¼šåœ¨ç¼ºå¤±ç»´åº¦å’Œè½´é•¿åº¦ä¸º1çš„ç»´åº¦ä¸Šè¿›è¡Œï¼š

1. ä¸¤ä¸ªæ•°ç»„åœ¨æŸä¸ªç»´åº¦ä¸Šçš„å¤§å°ç›¸ç­‰ã€‚
2. å…¶ä¸­ä¸€ä¸ªæ•°ç»„çš„æŸä¸ªç»´åº¦å¤§å°ä¸º `1`ï¼Œå¯ä»¥æ‰©å±•ä¸ºä¸å¦ä¸€ä¸ªæ•°ç»„è¯¥ç»´åº¦çš„å¤§å°ä¸€è‡´ã€‚

å¦‚æœä»¥ä¸Šæ¡ä»¶éƒ½ä¸æ»¡è¶³ï¼ŒNumPy å°†æŠ›å‡º `ValueError`ã€‚

â€œ**ä»å³å‘å·¦**â€ æ˜¯æŒ‡åœ¨ NumPy å¹¿æ’­æœºåˆ¶ä¸­ï¼Œ**æ¯”è¾ƒæ•°ç»„å½¢çŠ¶æ—¶ä»æœ€åä¸€ä¸ªç»´åº¦ï¼ˆå³æœ€å³è¾¹çš„ç»´åº¦ï¼‰å¼€å§‹ä¾æ¬¡å¾€å‰å¯¹æ¯”**ã€‚è¿™æ˜¯ä¸ºäº†ä»æ›´å†…å±‚çš„ç»´åº¦åˆ°æ›´å¤–å±‚çš„ç»´åº¦é€æ­¥æ‰©å±•ï¼Œä½¿å¹¿æ’­æ“ä½œæ›´çµæ´»ã€‚



## 2.16 pythonä¸­çš„å‘é‡

å°½é‡ä¸è¦ä½¿ç”¨ä¸€ç»´å‘é‡(5,)è¿™ç±»çš„ï¼Œè¿™ä¼šä½¿ä»£ç å˜å¾—éš¾ä»¥è°ƒè¯•

å¦‚æœæˆ‘å®Œå…¨ç¡®å®šä¸€ä¸ªå‘é‡çš„ç»´åº¦(**dimension**)ï¼Œæ‰”è¿›ä¸€ä¸ªæ–­è¨€è¯­å¥(**assertion statement**)ã€‚

- ```python
  assert(a.shape == (5,1))
  ```

å¤šä½¿ç”¨reshapeï¼Œè¿™ä¸ªæ“ä½œæ˜¯O(1)çš„ï¼Œæ‰€ä»¥å‡ ä¹æ²¡æœ‰æ€§èƒ½æŸè€—

## 2.18 é€»è¾‘å›å½’æŸå¤±å‡½æ•°çš„è§£é‡Š

çº¦å®š $\hat{y}=p(y=1|x)$ ï¼Œå³ç®—æ³•çš„è¾“å‡º$\hat{y}$ æ˜¯ç»™å®šè®­ç»ƒæ ·æœ¬ $x$ æ¡ä»¶ä¸‹ $y$ ç­‰äº1çš„æ¦‚ç‡ã€‚

ç”±æ­¤å¯çŸ¥
$$
if\ y=1:\ p(y|x)=\hat{y}\\
if\ y=0:\ p(y|x)=1-\hat{y}
$$
ç”±äºè®¨è®ºçš„æ˜¯äºŒåˆ†ç±»é—®é¢˜çš„æŸå¤±å‡½æ•°ï¼Œå› æ­¤ï¼Œ$y$çš„å–å€¼åªèƒ½æ˜¯0æˆ–è€…1ã€‚ä¸Šè¿°çš„ä¸¤ä¸ªæ¡ä»¶æ¦‚ç‡å…¬å¼å¯ä»¥åˆå¹¶æˆå¦‚ä¸‹å…¬å¼ï¼š

$$
p(y|x)={\hat{y}}^{y}{(1-\hat{y})}^{(1-y)}
$$
å› ä¸º log æ˜¯å•è°ƒé€’å¢çš„å‡½æ•°ï¼Œæ‰€ä»¥æœ€å¤§åŒ– $log(p(y|x))$ ç­‰ä»·äºæœ€å¤§åŒ– $p(y|x)$

å› æ­¤å¾—åˆ°æŸå¤±å‡½æ•°
$$
-L\left( \hat{y},y \right)=y\log(\hat{y})+(1-y)\log (1-\hat{y})
$$

- ä¹‹æ‰€ä»¥åœ¨è®­ç»ƒæ—¶ï¼ŒæŸå¤±å‡½æ•°å–ä¸Šè¿°å¼å­çš„è´Ÿæ•°ï¼Œæ˜¯å› ä¸ºè®­ç»ƒå­¦ä¹ ç®—æ³•æ—¶éœ€è¦ç®—æ³•è¾“å‡ºå€¼çš„æ¦‚ç‡æ˜¯æœ€å¤§çš„ï¼ˆä»¥æœ€å¤§çš„æ¦‚ç‡é¢„æµ‹è¿™ä¸ªå€¼ï¼‰ï¼Œç„¶è€Œåœ¨é€»è¾‘å›å½’ä¸­æˆ‘ä»¬éœ€è¦æœ€å°åŒ–æŸå¤±å‡½æ•°

**mä¸ªæ ·æœ¬çš„ä»£ä»·å‡½æ•°**

å‡è®¾æ‰€æœ‰çš„è®­ç»ƒæ ·æœ¬æœä»åŒä¸€åˆ†å¸ƒä¸”ç›¸äº’ç‹¬ç«‹ï¼Œä¹Ÿå³ç‹¬ç«‹åŒåˆ†å¸ƒçš„ï¼Œæ‰€æœ‰è¿™äº›æ ·æœ¬çš„è”åˆæ¦‚ç‡å°±æ˜¯æ¯ä¸ªæ ·æœ¬æ¦‚ç‡çš„ä¹˜ç§¯:

$$
P\left(\text{labels  in training set} \right) = \prod_{i =1}^{m}{P(y^{(i)}|x^{(i)})}
$$
åšæœ€å¤§ä¼¼ç„¶ä¼°è®¡ï¼Œéœ€è¦å¯»æ‰¾ä¸€ç»„å‚æ•°ï¼Œä½¿å¾—ç»™å®šæ ·æœ¬çš„è§‚æµ‹å€¼æ¦‚ç‡æœ€å¤§ï¼Œä»¤è¿™ä¸ªæ¦‚ç‡æœ€å¤§åŒ–ç­‰ä»·äºä»¤å…¶å¯¹æ•°æœ€å¤§åŒ–ï¼Œåœ¨ç­‰å¼ä¸¤è¾¹å–å¯¹æ•°ï¼š

$$
logp\left( \text{labels  in  training set} \right) = log\prod_{i =1}^{m}{P(y^{(i)}|x^{(i)})} = \sum_{i = 1}^{m}{logP(y^{(i)}|x^{(i)})} = \sum_{i =1}^{m}{- L(\hat y^{(i)},y^{(i)})}
$$
æ¨å¯¼å‡ºäº†å‰é¢ç»™å‡ºçš„**logistic**å›å½’çš„æˆæœ¬å‡½æ•°$J(w,b)= \sum_{i = 1}^{m}{L(\hat y^{(i)},y^{\hat( i)})}$ï¼Œè¦æ±‚å…¶æœ€å°åŒ–



# ç¬¬ä¸‰å‘¨ ç¥ç»ç½‘ç»œ

## 3.1 ç¥ç»ç½‘ç»œæ¦‚è§ˆ

![image-20241128190820955](assets/image-20241128190820955.png)

ä½¿ç”¨ç¬¦å·$^{[m]}$è¡¨ç¤ºç¬¬$m$å±‚ç½‘ç»œä¸­èŠ‚ç‚¹ç›¸å…³çš„æ•°ï¼Œè¿™äº›èŠ‚ç‚¹çš„é›†åˆè¢«ç§°ä¸ºç¬¬$m$å±‚ç½‘ç»œã€‚è¿™æ ·å¯ä»¥ä¿è¯$^{[m]}$ä¸ä¼šå’Œæˆ‘ä»¬ä¹‹å‰ç”¨æ¥è¡¨ç¤ºå•ä¸ªçš„è®­ç»ƒæ ·æœ¬çš„$^{(i)}$(å³æˆ‘ä»¬ä½¿ç”¨è¡¨ç¤ºç¬¬$i$ä¸ªè®­ç»ƒæ ·æœ¬)æ··æ·†ï¼›
æ•´ä¸ªè®¡ç®—è¿‡ç¨‹ï¼Œå…¬å¼å¦‚ä¸‹:
$$
\left.
	\begin{array}{r}
	{x }\\
	{W^{[1]}}\\
	{b^{[1]}}
	\end{array}
	\right\}
	\implies{z^{[1]}=W^{[1]}x+b^{[1]}}
	\implies{a^{[1]} = \sigma(z^{[1]})}
$$

$$
\left.
	\begin{array}{r}
	\text{$a^{[1]} = \sigma(z^{[1]})$}\\
	\text{$W^{[2]}$}\\
	\text{$b^{[2]}$}\\
	\end{array}
	\right\}
	\implies{z^{[2]}=W^{[2]}a^{[1]}+b^{[2]}}
	\implies{a^{[2]} = \sigma(z^{[2]})}\\ 
	\implies{{L}\left(a^{[2]},y \right)}
$$

**åå‘ä¼ æ’­**
$$
\left.
	\begin{array}{r}
	{da^{[1]} = {d}\sigma(z^{[1]})}\\
	{dW^{[2]}}\\
	{db^{[2]}}\\
	\end{array}
	\right\}
	\impliedby{{dz}^{[2]}={d}(W^{[2]}\alpha^{[1]}+b^{[2]}})
	\impliedby{{{da}^{[2]}} = {d}\sigma(z^{[2]})}\\
	\impliedby{{dL}\left(a^{[2]},y \right)}
$$


## 3.2 ç¥ç»ç½‘ç»œçš„è¡¨ç¤º

æœ¯è¯­éšè—å±‚çš„å«ä¹‰æ˜¯åœ¨è®­ç»ƒé›†ä¸­ï¼Œè¿™äº›ä¸­é—´ç»“ç‚¹çš„å‡†ç¡®å€¼æˆ‘ä»¬æ˜¯ä¸çŸ¥é“åˆ°çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ä½ çœ‹ä¸è§å®ƒä»¬åœ¨è®­ç»ƒé›†ä¸­åº”å…·æœ‰çš„å€¼ã€‚

è®°å·$a^{[0]}$å¯ä»¥ç”¨æ¥è¡¨ç¤ºè¾“å…¥ç‰¹å¾ã€‚$a$è¡¨ç¤ºæ¿€æ´»çš„æ„æ€ï¼Œå®ƒæ„å‘³ç€ç½‘ç»œä¸­ä¸åŒå±‚çš„å€¼ä¼šä¼ é€’åˆ°å®ƒä»¬åé¢çš„å±‚ä¸­ï¼Œè¾“å…¥å±‚å°†$x$ä¼ é€’ç»™éšè—å±‚ï¼Œæ‰€ä»¥æˆ‘ä»¬å°†è¾“å…¥å±‚çš„æ¿€æ´»å€¼ç§°ä¸º$a^{[0]}$ï¼›ä¸‹ä¸€å±‚å³éšè—å±‚ä¹ŸåŒæ ·ä¼šäº§ç”Ÿä¸€äº›æ¿€æ´»å€¼ï¼Œé‚£ä¹ˆæˆ‘å°†å…¶è®°ä½œ$a^{[1]}$ï¼Œæ‰€ä»¥å…·ä½“åœ°ï¼Œè¿™é‡Œçš„ç¬¬ä¸€ä¸ªå•å…ƒæˆ–ç»“ç‚¹æˆ‘ä»¬å°†å…¶è¡¨ç¤ºä¸º$a^{[1]}_{1}$ï¼Œç¬¬äºŒä¸ªç»“ç‚¹çš„å€¼æˆ‘ä»¬è®°ä¸º$a^{[1]}_{2}$ï¼Œä¾æ­¤ç±»æ¨

æœ€åè¾“å‡ºå±‚å°†äº§ç”ŸæŸä¸ªæ•°å€¼$a$ï¼Œå®ƒåªæ˜¯ä¸€ä¸ªå•ç‹¬çš„å®æ•°ï¼Œæ‰€ä»¥çš„$\hat{y}$å€¼å°†å–ä¸º$a^{[2]}$ã€‚

åœ¨çº¦å®šä¿—æˆçš„ç¬¦å·ä¼ ç»Ÿä¸­ï¼Œåœ¨è¿™é‡Œä½ æ‰€çœ‹åˆ°çš„è¿™ä¸ªä¾‹å­ï¼Œåªèƒ½å«åšä¸€ä¸ªä¸¤å±‚çš„ç¥ç»ç½‘ç»œã€‚åŸå› æ˜¯å½“æˆ‘ä»¬è®¡ç®—ç½‘ç»œçš„å±‚æ•°æ—¶ï¼Œè¾“å…¥å±‚æ˜¯ä¸ç®—å…¥æ€»å±‚æ•°å†…ï¼Œæ‰€ä»¥éšè—å±‚æ˜¯ç¬¬ä¸€å±‚ï¼Œè¾“å‡ºå±‚æ˜¯ç¬¬äºŒå±‚ã€‚ç¬¬äºŒä¸ªæƒ¯ä¾‹æ˜¯æˆ‘ä»¬å°†è¾“å…¥å±‚ç§°ä¸ºç¬¬é›¶å±‚ï¼Œæ‰€ä»¥åœ¨æŠ€æœ¯ä¸Šï¼Œè¿™ä»ç„¶æ˜¯ä¸€ä¸ªä¸‰å±‚çš„ç¥ç»ç½‘ç»œï¼Œå› ä¸ºè¿™é‡Œæœ‰è¾“å…¥å±‚ã€éšè—å±‚ï¼Œè¿˜æœ‰è¾“å‡ºå±‚ã€‚ä½†æ˜¯åœ¨ä¼ ç»Ÿçš„ç¬¦å·ä½¿ç”¨ä¸­ï¼Œå¦‚æœä½ é˜…è¯»ç ”ç©¶è®ºæ–‡æˆ–è€…åœ¨è¿™é—¨è¯¾ä¸­ï¼Œä½ ä¼šçœ‹åˆ°äººä»¬å°†è¿™ä¸ªç¥ç»ç½‘ç»œç§°ä¸ºä¸€ä¸ªä¸¤å±‚çš„ç¥ç»ç½‘ç»œï¼Œå› ä¸ºæˆ‘ä»¬ä¸å°†è¾“å…¥å±‚çœ‹ä½œä¸€ä¸ªæ ‡å‡†çš„å±‚ã€‚



## 3.3 è®¡ç®—ç¥ç»ç½‘ç»œçš„è¾“å‡º

![image-20241128201044414](assets/image-20241128201044414.png)
$$
a^{[1]} =
	\left[
		\begin{array}{c}
		a^{[1]}_{1}\\
		a^{[1]}_{2}\\
		a^{[1]}_{3}\\
		a^{[1]}_{4}
		\end{array}
		\right]
		= \sigma(z^{[1]})
$$

$$
\left[
		\begin{array}{c}
		z^{[1]}_{1}\\
		z^{[1]}_{2}\\
		z^{[1]}_{3}\\
		z^{[1]}_{4}\\
		\end{array}
		\right]
		 =
	\overbrace{
	\left[
		\begin{array}{c}
		...W^{[1]T}_{1}...\\
		...W^{[1]T}_{2}...\\
		...W^{[1]T}_{3}...\\
		...W^{[1]T}_{4}...
		\end{array}
		\right]
		}^{W^{[1]}}
		*
	\overbrace{
	\left[
		\begin{array}{c}
		x_1\\
		x_2\\
		x_3\\
		\end{array}
		\right]
		}^{input}
		+
	\overbrace{
	\left[
		\begin{array}{c}
		b^{[1]}_1\\
		b^{[1]}_2\\
		b^{[1]}_3\\
		b^{[1]}_4\\
		\end{array}
		\right]
		}^{b^{[1]}}
$$

 ![image-20241128201650185](assets/image-20241128201650185.png)



## 3.4 å¤šä¸ªæ ·æœ¬çš„å‘é‡åŒ–

$$
x =
	\left[
		\begin{array}{c}
		\vdots & \vdots & \vdots & \vdots\\
		x^{(1)} & x^{(2)} & \cdots & x^{(m)}\\
		\vdots & \vdots & \vdots & \vdots\\
		\end{array}
		\right]
$$


$$
W^{[1]}=
	\left[
		\begin{array}{c}
		...W^{[1]T}_{1}...\\
		...W^{[1]T}_{2}...\\
		...W^{[1]T}_{3}...\\
		...W^{[1]T}_{4}...
		\end{array}
		\right]
$$

$$
Z^{[1]} =
	\left[
		\begin{array}{c}
		\vdots & \vdots & \vdots & \vdots\\
		z^{[1](1)} & z^{[1](2)} & \cdots & z^{[1](m)}\\
		\vdots & \vdots & \vdots & \vdots\\
		\end{array}
		\right]
$$

$$
A^{[1]} =
	\left[
		\begin{array}{c}
		\vdots & \vdots & \vdots & \vdots\\
		\alpha^{[1](1)} & \alpha^{[1](2)} & \cdots & \alpha^{[1](m)}\\
		\vdots & \vdots & \vdots & \vdots\\
		\end{array}
		\right]
$$

$$
\left.
		\begin{array}{r}
		\text{$z^{[1](i)} = W^{[1](i)}x^{(i)} + b^{[1]}$}\\
		\text{$\alpha^{[1](i)} = \sigma(z^{[1](i)})$}\\
		\text{$z^{[2](i)} = W^{[2](i)}\alpha^{[1](i)} + b^{[2]}$}\\
		\text{$\alpha^{[2](i)} = \sigma(z^{[2](i)})$}\\
		\end{array}
		\right\}
		\implies
		\begin{cases}
		\text{$Z^{[1]}=W^{[1]}X+b^{[1]}$}\\
		\text{$A^{[1]} = \sigma(z^{[1]})$}\\
		\text{$z^{[2]} = W^{[2]}A^{[1]} + b^{[2]}$}\\ 
		\text{$A^{[2]} = \sigma(z^{[2]})$}\\ 
		\end{cases}
$$


